<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BNI — Seek of the Week Submissions</title>

<style>
  :root{
    --bni-red:#cf2030;            /* BNI red */
    --container-w:1200px;         /* Max width for header brand row */
    --header-h:30px;              /* <<< Adjust HEADER HEIGHT here */
    --footer-h:30px;              /* <<< Adjust FOOTER HEIGHT here */
    --brand-logo-w:700px;         /* <<< Adjust BNI LOGO WIDTH here (height auto) */
    --badge-opacity:0.6;          /* <<< Segwik badge transparency (0–1) */
    --badge-size:15px;
    --badge-gap:10px;
    --ink:#1f2937;
    --muted:#6b7280;
    --line:#e5e7eb;
    --card:#ffffff;
    --bg:#ffffff;
    --radius:12px;
  }

  *{ box-sizing:border-box; }
  body{
    margin:0;
    font-family: Arial, Helvetica, sans-serif;
    color:var(--ink);
    background:var(--bg);
  }

  /* Frame */
  .site{
    width:100%;
    margin:0 auto;
    min-height:100vh;
    display:flex;
    flex-direction:column;
  }
  .topbar{ background:var(--bni-red); height:var(--header-h); }
  .brand-row{
    width:min(100%, var(--container-w));
    margin:0 auto;
    display:flex; align-items:center; gap:16px;
    padding:18px 20px; border-bottom:1px solid #eee;
  }
  .brand-row .logo{
    width: clamp(200px, 50vw, var(--brand-logo-w));
    max-width:100%; height:auto; display:block;
  }

  /* Content */
  .content{
    flex:1 0 auto;
    padding: clamp(16px, 2vw, 32px);
    background:#fff;
  }

  /* Cards layout — always two columns on desktop/tablet, one-by-one on mobile */
  .cards{
    display:grid;
    grid-template-columns: repeat(2, minmax(280px, 1fr));
    gap:16px;
    align-items:start;
  }
  @media (max-width: 900px){
    .cards{
      grid-template-columns: 1fr; /* one-by-one for mobile ONLY */
    }
  }

  /* “Header” cells that sit OUTSIDE the cards, above the first two positions */
  .grid-head{
    display:flex; align-items:center; justify-content:space-between;
    min-height:40px;
  }
  .grid-head.left{ justify-content:flex-start; }
  .grid-head.right{ justify-content:flex-end; }
  .page-title{
    margin:0; font-size:30px; font-weight:800;
  }
  .btn{
    appearance:none; border:0; background:var(--bni-red); color:#fff;
    font-weight:700; padding:10px 14px; border-radius:8px; cursor:pointer;
    font-size:14px; text-decoration:none; white-space:nowrap; display:inline-block;
  }

  /* Seek cards */
  .seek-card{
    position:relative;
    background:var(--card);
    border:1px solid var(--line);
    border-radius: var(--radius);
    padding:16px;
    box-shadow:0 8px 24px rgba(0,0,0,0.06);
  }
  .seek-head{
    display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
    margin-bottom:10px;
  }
  .head-left{
    display:flex; align-items:center; gap:8px; flex-wrap:wrap;
  }
  .pill{
    display:inline-block; padding:6px 10px; border-radius:999px;
    font-size:12px; line-height:1; background:#f3f4f6; color:#111;
    border:1px solid var(--line);
  }
  .pill.red{
    background:#ffe6e9; color:#9a1027; border-color:#f2b7bf;
  }
  .when{ color:var(--muted); font-size:12px; }

  .seek-title{
    margin:0 0 6px; font-size:16px; font-weight:700;
  }
  .details{
    display:grid; gap:4px; font-size:14px;
  }
  .label{ font-weight:700; }

  .seek-actions{
    margin-top:16px; display:flex; gap:10px; flex-wrap:wrap;
  }
/* Ensure space after details (whether clamped or not) */
.details,
.collapsible { 
  margin-bottom: 14px;      /* minimum space before the button row */
}

/* Make the “See more” link also create space before buttons */
.see-toggle { 
  display: inline-block; 
  margin: 8px 0 14px; 
}

/* Hard stop: add a top border + padding for the button row */
.seek-actions { 
  border-top: 1px solid #e5e7eb; 
  padding-top: 12px; 
}

  /* Inline referral form */
  .inline-form{
    margin-top:12px;
    border-top:1px dashed var(--line);
    padding-top:12px;
  }
  .row{ display:flex; gap:10px; align-items:center; }
  .row > *{ flex:1; }
  .field{ margin-bottom:10px; }
  .field .label{ display:block; font-size:13px; margin-bottom:6px; }
  input[type="text"], input[type="email"], input[type="tel"], textarea, select{
    width:100%; border:1px solid var(--line); border-radius:8px;
    padding:10px 12px; font-size:14px; outline:none;
  }
  textarea{ min-height:90px; resize:vertical; }
  .divider{ height:1px; background:#e5e7eb; margin:6px 0 10px; }

  /* Footer */
  .footer{
    background:var(--bni-red); height:var(--footer-h);
    display:flex; align-items:center; justify-content:center; color:#fff; font-weight:600;
    letter-spacing:.3px;
  }

  /* Sticky Segwik badge */
  .powered-by{
    position:fixed; right:18px; bottom:18px; z-index:9999;
    display:inline-flex; align-items:center; gap:var(--badge-gap);
    background:rgba(255,255,255,0.9); border:1px solid rgba(0,0,0,0.08);
    border-radius:999px; padding:8px 12px; box-shadow:0 6px 18px rgba(0,0,0,0.08);
    opacity:var(--badge-opacity); transition:opacity .2s ease; backdrop-filter:blur(6px);
  }
  .powered-by:hover{ opacity:1; }
  .powered-by span{ font-size:var(--badge-size); line-height:1; color:#111827; white-space:nowrap; }
  .powered-by img{ height:calc(var(--badge-size) + 6px); width:auto; display:block; }

  .seek-title{ color: var(--muted); }
/* Make each card stretch to the same height in a grid row */
.cards { align-items: stretch; }
.seek-card{
  display:flex;           /* lets footer/buttons stick to bottom */
  flex-direction:column;
}

/* Collapsible body: truncated by default */
.collapsible{
  --clamp-max: 180px;     /* <<< adjust how tall before “See more” appears */
  position: relative;
  max-height: var(--clamp-max);
  overflow: hidden;
  transition: max-height .25s ease;
}

/* Fade-out at bottom when clamped */
.collapsible.clamped::after{
  content:"";
  position:absolute; left:0; right:0; bottom:0; height:48px;
  background: linear-gradient(to bottom, rgba(255,255,255,0), #fff 60%);
}

/* The row of actions sticks to the bottom */
.seek-actions{ margin-top:auto; }

/* See more / See less link */
.see-toggle{
  display:inline-block;
  margin-top:8px;
  font-size:13px;
  color:#374151;
  text-decoration:underline;
  cursor:pointer;
}

/* Mobile: we don’t equalize heights (one column) */
@media (max-width: 900px){
  .seek-card{ min-height: auto !important; }
}

</style>
</head>

<body>
  <div class="site">
    <div class="topbar" aria-hidden="true"></div>

    <div class="brand-row">
      <img class="logo" src="https://d34hmiuaex7c0.cloudfront.net/6568/uploads/cmaspages/gallery/galleryitem_1759854726598.png" alt="BNI Rock Solid Referrals Logo">
    </div>

    <main class="content" role="main">
      <!-- The grid contains two “header” cells followed by the cards -->
      <section class="cards" id="cards">
        <!-- JS will inject: header left (title), header right (button), then cards -->
      </section>
    </main>

    <footer class="footer" role="contentinfo">
      <div>BNI Rock Solid Referrals</div>
    </footer>
  </div>

  <!-- STICKY "Powered by Segwik" BADGE -->
  <a class="powered-by" href="https://segwik.com/" aria-label="Powered by Segwik (opens portal)" target="_blank" rel="noopener">
    <span>Powered by</span>
    <img src="https://d34hmiuaex7c0.cloudfront.net/6568/uploads/cmaspages/gallery/galleryitem_1759854883923.png" alt="Segwik">
  </a>

<script>
/* ===== Demo + persistence ===== */
const LIST_KEY = "bni_seek_requests_list_v2";
/* Also pull from submit page if present */
const SUBMIT_KEY = "bni_seeks_submit_only_v5";

/* Utilities */
const $ = (s, el=document) => el.querySelector(s);
const $$ = (s, el=document) => Array.from(el.querySelectorAll(s));
const uid = () => Math.random().toString(36).slice(2,9);

/* Date helpers for “Today / Yesterday / Last Week / Last Month / MMM D, YYYY” */
function startOfDay(ts){ const d = new Date(ts); d.setHours(0,0,0,0); return d.getTime(); }
function prettyWhen(ts){
  const now = new Date();
  const t = new Date(ts);
  const msInDay = 86400000;
  const todayStart = startOfDay(now);
  const targetStart = startOfDay(t);
  const diffDays = Math.floor((todayStart - targetStart) / msInDay);

  if (diffDays === 0) return "Today";
  if (diffDays === 1) return "Yesterday";
  if (diffDays < 7) return "Last Week";
  // “Last Month” ≈ within past 30 days but ≥ 7 days ago
  if (diffDays < 30) return "Last Month";

  const monthNames = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
  return `${monthNames[t.getMonth()]} ${t.getDate()}, ${t.getFullYear()}`;
}

/* Seed demo with explicit dates: Today, Yesterday, Last Week, Last Month, and Older */
const now = Date.now();
const day = 86400000;
const demo = [
  // TODAY — Specific Person
  {
    id: "d1", type:"person",
    createdAt: now - 2*60*60*1000, // 2 hours ago
    referrals:[{id:"r1",name:"Casey Nguyen"},{id:"r2",name:"Michael Ortiz"}],
    personFirst:"Jordan", personLast:"Lee", personCompany:"Lee Home Inspections",
    whatActions:"Warm email intro and include both parties.",
    whatSay:"Jordan helped our buyers avoid a costly issue — worth a quick chat.",
    notes:"Monmouth County homeowners preferred."
  },
  // YESTERDAY — Specific Company
  {
    id: "d2", type:"company",
    createdAt: now - 1*day - 3*60*60*1000, // yesterday
    referrals:[{id:"r3",name:"Alex Wu"}],
    companyName:"Acme Builders LLC",
    whatActions:"Intro via LinkedIn and share calendar link.",
    whatSay:"Pete’s team can streamline subcontractor onboarding.",
    notes:"Open to meeting on Fridays."
  },
  // LAST WEEK — Type of Person
  {
    id: "d3", type:"persona",
    createdAt: now - 7*day - 2*60*60*1000, // ~ last week
    referrals:[],
    personaIndustry:"Real Estate", personaTitle:"Office Manager", personaSeniority:"Mid-Level",
    whatActions:"Ask for a 15-minute discovery call.",
    whatSay:"We reduce admin back-and-forth with a simple portal.",
    notes:"Within 25 miles of Oakhurst."
  },
  // LAST MONTH — Specific Person
  {
    id: "d4", type:"person",
    createdAt: now - 20*day, // ~ last month bucket
    referrals:[{id:"r4",name:"Sofia Patel"}],
    personFirst:"Dana", personLast:"Kim", personCompany:"",
    whatActions:"Make a group text intro.",
    whatSay:"Dana is a trusted adviser for investment buyers.",
    notes:"Best reached in afternoons."
  },
  // OLDER — Specific Company (explicit date: Jan 12, 2025)
  {
    id: "d5", type:"company",
    createdAt: new Date("2025-01-12T10:00:00").getTime(),
    referrals:[],
    companyName:"Brightline Solar Inc.",
    whatActions:"Share their ops contact; we’ll send a brief capabilities deck.",
    whatSay:"Our team helped neighbors cut energy bills by 23%.",
    notes:"Prefer Mon–Thu mornings."
  },
  // OLDER — Type of Person (explicit date)
  {
    id: "d6", type:"persona",
    createdAt: new Date("2025-02-03T14:30:00").getTime(),
    referrals:[{id:"r5",name:"Taylor Brooks"}],
    personaIndustry:"Healthcare", personaTitle:"HR Director", personaSeniority:"Senior",
    whatActions:"Ask for a quick intro call this week.",
    whatSay:"We modernize benefits enrollment without extra cost.",
    notes:"NJ/NY area ideal."
  }
];

/* Persistence */
function loadList(){
  const stored = localStorage.getItem(LIST_KEY);
  let list = stored ? JSON.parse(stored) : null;

  if(!list){
    // Merge any submissions from the submit page (no referrals by default)
    let fromSubmit = [];
    const raw = localStorage.getItem(SUBMIT_KEY);
    if(raw){
      try{
        const subs = JSON.parse(raw);
        fromSubmit = subs.map(s => ({
          ...s,
          referrals: s.referrals || [],
          createdAt: s.createdAt || Date.now()
        }));
      }catch(e){}
    }
    list = demo.concat(fromSubmit);
    // Sort newest -> oldest
    list.sort((a,b) => (b.createdAt||0) - (a.createdAt||0));
    localStorage.setItem(LIST_KEY, JSON.stringify(list));
  } else {
    list.sort((a,b) => (b.createdAt||0) - (a.createdAt||0));
  }
  return list;
}
function saveList(list){ localStorage.setItem(LIST_KEY, JSON.stringify(list)); }

/* Labels */
function typeLabel(t){
  if(t==="person") return "Specific Person";
  if(t==="company") return "Specific Company";
  return "Type of Person";
}
function actionButtonText(t){
  if(t==="person") return "I know her/him";
  if(t==="company") return "I know this company";
  return "I know someone";
}
function headingText(t){
  const b = `${typeLabel(t)}`;
  return `A member is looking for a ${b}`;
}

/* Card factory */
function renderCard(req){
  const wrap = document.createElement("article");
  wrap.className = "seek-card";
  wrap.dataset.id = req.id;

  const head = document.createElement("div");
  head.className = "seek-head";
  const left = document.createElement("div");
  left.className = "head-left";
  left.innerHTML = `
    <span class="pill">${typeLabel(req.type)}</span>
    <span class="when">${prettyWhen(req.createdAt || Date.now())}</span>
  `;
  const right = document.createElement("div");
  right.innerHTML = `
    <span class="pill red" data-role="count">${(req.referrals||[]).length} referral${(req.referrals||[]).length===1?'':'s'}</span>
  `;
  head.appendChild(left);
  head.appendChild(right);

  const title = document.createElement("h3");
  title.className = "seek-title";
  title.innerHTML = headingText(req.type);

  const det = document.createElement("div");
  det.className = "details";
  if(req.type === "person"){
    const full = [req.personFirst, req.personLast].filter(Boolean).join(" ");
    det.innerHTML = `
      <div><span class="label">Name:</span> ${full || "—"}</div>
      <div><span class="label">Company:</span> ${req.personCompany || "—"}</div>
      <div><span class="label">How You Can Help or Get Involved:</span> ${req.whatActions || "—"}</div>
      <div><span class="label">What to Share or Talk About:</span> ${req.whatSay || "—"}</div>
      <div><span class="label">Additional Notes:</span> ${req.notes || "—"}</div>
    `;
  } else if(req.type === "company"){
    det.innerHTML = `
      <div><span class="label">Company:</span> ${req.companyName || "—"}</div>
      <div><span class="label">How You Can Help or Get Involved:</span> ${req.whatActions || "—"}</div>
      <div><span class="label">What to Share or Talk About:</span> ${req.whatSay || "—"}</div>
      <div><span class="label">Additional Notes:</span> ${req.notes || "—"}</div>
    `;
  } else {
    det.innerHTML = `
      <div><span class="label">Industry:</span> ${req.personaIndustry || "—"}</div>
      <div><span class="label">Job Title:</span> ${req.personaTitle || "—"}</div>
      <div><span class="label">Experience / Seniority:</span> ${req.personaSeniority || "—"}</div>
      <div><span class="label">How You Can Help or Get Involved:</span> ${req.whatActions || "—"}</div>
      <div><span class="label">What to Share or Talk About:</span> ${req.whatSay || "—"}</div>
      <div><span class="label">Additional Notes:</span> ${req.notes || "—"}</div>
    `;
  }

  const actions = document.createElement("div");
  actions.className = "seek-actions";
  const actBtn = document.createElement("button");
  actBtn.className = "btn";
  actBtn.textContent = actionButtonText(req.type);
  actions.appendChild(actBtn);

  actBtn.addEventListener("click", () => toggleInlineForm(wrap, req));

  wrap.appendChild(head);
  wrap.appendChild(title);
  wrap.appendChild(det);
  wrap.appendChild(actions);

  return wrap;
}

/* Inline referral form */
function toggleInlineForm(card, req){
  let form = card.querySelector(".inline-form");
  if(form){ form.remove(); return; }

  form = document.createElement("div");
  form.className = "inline-form";
  form.innerHTML = `
    <div class="row field">
      <div>
        <label class="label">Your First Name</label>
        <input type="text" data-f="first">
      </div>
      <div>
        <label class="label">Your Last Name</label>
        <input type="text" data-f="last">
      </div>
    </div>
    <div class="row field">
      <div>
        <label class="label">Your Company</label>
        <input type="text" data-f="company">
      </div>
      <div>
        <label class="label">Your Email</label>
        <input type="email" data-f="email">
      </div>
    </div>
    <div class="field">
      <label class="label">Your Phone</label>
      <input type="tel" data-f="phone">
    </div>

    <div class="divider"></div>

    ${req.type === "person" ? `
      <div class="field">
        <label class="label">Relationship / How you know them</label>
        <input type="text" data-f="relation">
      </div>
      <div class="field">
        <label class="label">Write a quick message to help them out</label>
        <textarea data-f="message"></textarea>
      </div>
    ` : req.type === "company" ? `
      <div class="field">
        <label class="label">Person you’re connected with in this company</label>
        <input type="text" data-f="contactName">
      </div>
      <div class="field">
        <label class="label">Relationship / How you know them</label>
        <input type="text" data-f="relation">
      </div>
      <div class="field">
        <label class="label">Write a quick message to help them out</label>
        <textarea data-f="message"></textarea>
      </div>
    ` : `
      <div class="field">
        <label class="label">Name of the Person you know</label>
        <input type="text" data-f="contactName">
      </div>
      <div class="field">
        <label class="label">Relationship / How you know them</label>
        <input type="text" data-f="relation">
      </div>
      <div class="field">
        <label class="label">Write a quick message to help them out</label>
        <textarea data-f="message"></textarea>
      </div>
    `}

    <div class="seek-actions">
      <button class="btn" data-action="offer">Send Response</button>
      <button class="btn" style="background:#f3f4f6; color:#111; border:1px solid var(--line);" data-action="cancel">Cancel</button>
    </div>
  `;

  card.appendChild(form);

  form.querySelector('[data-action="cancel"]').addEventListener("click", () => {
    form.remove();
  });

  form.querySelector('[data-action="offer"]').addEventListener("click", () => {
    const val = (n) => (form.querySelector(`[data-f="${n}"]`)?.value || "").trim();
    const first = val("first"), last = val("last"), email = val("email"), phone = val("phone");
    if(!first || !last){ alert("Please provide your first and last name."); return; }
    if(!email && !phone){ alert("Please provide your email or phone."); return; }

    const referral = {
      id: uid(),
      yourFirst:first,
      yourLast:last,
      yourCompany: val("company"),
      yourEmail: email,
      yourPhone: phone,
      contactName: val("contactName"),
      relation: val("relation"),
      message: val("message"),
      createdAt: Date.now()
    };

    addReferralTo(req.id, referral);
    form.remove();

    // Update count bubble
    const countEl = card.querySelector('[data-role="count"]');
    const list = getAll();
    const found = list.find(x => x.id === req.id);
    const count = (found?.referrals || []).length;
    if(countEl) countEl.textContent = `${count} referral${count===1?'':'s'}`;
  });
}

/* Data ops */
function getAll(){ return JSON.parse(localStorage.getItem(LIST_KEY) || "[]"); }
function addReferralTo(reqId, referral){
  const all = getAll();
  const idx = all.findIndex(r => r.id === reqId);
  if(idx === -1) return;
  all[idx].referrals = all[idx].referrals || [];
  all[idx].referrals.push(referral);
  saveList(all);
}

/* Build header cells and arrange positions for desktop vs mobile */
function buildHeaders(){
  const hLeft = document.createElement("div");
  hLeft.className = "grid-head left";
  hLeft.innerHTML = `<h1 class="page-title">Seek of the Week — Submissions</h1>`;

  const hRight = document.createElement("div");
  hRight.className = "grid-head right";
  const btn = document.createElement("a");
  btn.className = "btn";
  btn.href = "https://kakatbarilea-prog.github.io/bni-seek-of-the-week-page/"; // TODO: replace with the real submission page URL
  btn.textContent = "Submit a Seek";
  hRight.appendChild(btn);

  return { hLeft, hRight };
}

/* Render all cards and place headers as requested */
function renderAll(){
  const wrap = $("#cards");
  wrap.innerHTML = "";

  // Build and insert cards sorted newest -> oldest
  const all = loadList();

  // Create header nodes
  const { hLeft, hRight } = buildHeaders();

  // Desktop-first order: [header-left, header-right, card0, card1, card2...]
  wrap.appendChild(hLeft);
  wrap.appendChild(hRight);

  const cardEls = all.map(renderCard);
  cardEls.forEach(el => wrap.appendChild(el));

  // Then adjust for mobile so that the button appears above the 2nd card:
  arrangeHeaderPositions();

  // Listen to resize to re-arrange
  window.addEventListener("resize", arrangeHeaderPositions);
}

/* Ensure:
   - Desktop/tablet (>=901px): [header-left | header-right] on first row above first two cards
   - Mobile (<=900px): cards are one-by-one; order becomes: header-left, card0, header-right, card1, card2...
*/
function arrangeHeaderPositions(){
  const wrap = $("#cards");
  const isMobile = window.matchMedia("(max-width: 900px)").matches;

  const nodes = Array.from(wrap.children);
  const hLeft = nodes.find(n => n.classList.contains("left"));
  const hRight = nodes.find(n => n.classList.contains("right"));
  const cards = nodes.filter(n => n.classList.contains("seek-card"));

  if(!hLeft || !hRight || cards.length === 0) return;

  // Remove all, then re-insert in desired order
  nodes.forEach(n => wrap.removeChild(n));

  if(isMobile){
    // header-left, first card, header-right, rest of cards
    wrap.appendChild(hLeft);
    wrap.appendChild(cards[0]);
    wrap.appendChild(hRight);
    for(let i=1;i<cards.length;i++) wrap.appendChild(cards[i]);
  }else{
    // header-left, header-right, then all cards
    wrap.appendChild(hLeft);
    wrap.appendChild(hRight);
    cards.forEach(c => wrap.appendChild(c));
  }
}

/* Init */
renderAll();

  /* ----- CLAMP LONG CARDS WITH "SEE MORE" ----- */
function setupClamps(){
  // Add clamping + toggle for each card's details block
  $$(".seek-card .details").forEach(det => {
    det.classList.add("collapsible");

    // If content is taller than the clamp, show toggle
    const needsClamp = det.scrollHeight > parseInt(getComputedStyle(det).getPropertyValue("--clamp-max"));
    if(needsClamp){
      det.classList.add("clamped");
      const toggle = document.createElement("button");
      toggle.type = "button";
      toggle.className = "see-toggle";
      toggle.textContent = "… See more";
      toggle.addEventListener("click", () => {
        const isClamped = det.classList.toggle("clamped"); // toggles class
        if(isClamped){
          det.style.maxHeight = "";              // back to clamp var
          toggle.textContent = "… See more";
        }else{
          det.style.maxHeight = det.scrollHeight + "px"; // expand
          toggle.textContent = "See less";
        }
        // re-equalize row heights after expand/collapse
        equalizeHeights();
      });
      det.after(toggle);
    }
  });
}

/* ----- EQUAL HEIGHTS PER GRID ROW (desktop/tablet) ----- */
function equalizeHeights(){
  const isMobile = window.matchMedia("(max-width: 900px)").matches;
  if(isMobile){ 
    // Let natural height on mobile
    $$(".seek-card").forEach(c => c.style.minHeight = "");
    return;
  }

  // Group cards by their top offset (each grid row)
  const rows = new Map();
  $$(".seek-card").forEach(card => {
    card.style.minHeight = ""; // reset first
    const top = Math.round(card.getBoundingClientRect().top);
    if(!rows.has(top)) rows.set(top, []);
    rows.get(top).push(card);
  });

  // For each row, set all cards to the tallest min-height
  rows.forEach(cardsInRow => {
    let max = 0;
    cardsInRow.forEach(c => { max = Math.max(max, c.offsetHeight); });
    cardsInRow.forEach(c => { c.style.minHeight = max + "px"; });
  });
}
function renderAll(){
  const wrap = $("#cards");
  wrap.innerHTML = "";

  const all = loadList();
  const { hLeft, hRight } = buildHeaders();
  wrap.appendChild(hLeft);
  wrap.appendChild(hRight);
  all.map(renderCard).forEach(el => wrap.appendChild(el));

  arrangeHeaderPositions();
  setupClamps();       // <— add this
  equalizeHeights();   // <— and this

  window.addEventListener("resize", () => {
    arrangeHeaderPositions();
    equalizeHeights(); // recompute on resize
  });
}

</script>
</body>
</html>
