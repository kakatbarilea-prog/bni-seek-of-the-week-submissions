<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BNI — Seek of the Week Submissions</title>

<style>
  :root{
    --bni-red:#cf2030;
    --container-w:1200px;
    --header-h:30px;
    --footer-h:30px;
    --brand-logo-w:400px;
    --badge-opacity:0.6;
    --badge-size:15px;
    --badge-gap:10px;
    --ink:#1f2937;
    --muted:#6b7280;
    --line:#e5e7eb;
    --card:#ffffff;
    --bg:#ffffff;
    --radius:12px;
  }

  *{ box-sizing:border-box; }
  body{
    margin:0;
    font-family: Arial, Helvetica, sans-serif;
    color:var(--ink);
    background:var(--bg);
  }

  /* Frame */
  .site{
    width:100%;
    margin:0 auto;
    min-height:100vh;
    display:flex;
    flex-direction:column;
  }
  .topbar{ background:var(--bni-red); height:var(--header-h); }
  .brand-row{
    width:min(100%, var(--container-w));
    margin:0 auto;
    display:flex; align-items:center; gap:16px;
    padding:18px 20px; border-bottom:1px solid #eee;
  }
  .brand-row .logo{
    width: clamp(200px, 50vw, var(--brand-logo-w));
    max-width:100%; height:auto; display:block;
  }

  /* Content */
  .content{
    flex:1 0 auto;
    padding: clamp(16px, 2vw, 32px);
    background:#fff;
  }

  /* Header row */
  .page-head{
    display:flex; align-items:center; justify-content:space-between; gap:12px;
    margin-bottom:14px;
    flex-wrap:wrap;
  }
  .page-title{
    margin:0; font-size:30px; font-weight:800;
  }
  .btn{
    appearance:none; border:0; background:var(--bni-red); color:#fff;
    font-weight:700; padding:10px 14px; border-radius:8px; cursor:pointer;
    font-size:14px; text-decoration:none; white-space:nowrap; display:inline-block;
  }

  /* Filters */
  .filters{
    display:flex; gap:10px; align-items:center; flex-wrap:wrap;
    margin-bottom:14px;
  }
  .input, .select{
    border:1px solid var(--line);
    border-radius:8px;
    padding:10px 12px;
    font-size:14px;
    outline:none;
    background:#fff;
  }
  .input{ min-width:260px; flex:1 1 260px; }
  .select{ min-width:200px; }

  /* Cards layout — two columns desktop/tablet, one-by-one mobile */
  .cards{
    display:grid;
    grid-template-columns: repeat(2, minmax(280px, 1fr));
    gap:16px;
    align-items:start;
  }
  @media (max-width: 900px){
    .cards{ grid-template-columns: 1fr; }
  }

  /* Seek cards */
  .seek-card{
    position:relative;
    background:var(--card);
    border:1px solid var(--line);
    border-radius: var(--radius);
    padding:16px;
    box-shadow:0 8px 24px rgba(0,0,0,0.06);
    display:flex; flex-direction:column;
  }

  /* Card header with avatar + requester + looking for */
  .seek-top{
    display:flex; align-items:flex-start; gap:12px; margin-bottom:10px;
  }
  .avatar{
    width:42px; height:42px; border-radius:50%;
    flex:0 0 42px; overflow:hidden; display:grid; place-items:center;
    background:#f3f4f6; color:#374151; font-weight:800; font-size:14px;
    border:1px solid var(--line);
  }
  .avatar img{ width:100%; height:100%; object-fit:cover; display:block; }
  .who-line{
    margin:0; font-size:15px; line-height:1.35; color:var(--ink);
  }
  .who-line .name{ font-weight:800; }
  .who-line .type{ font-weight:800; }
  .meta{
    display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-top:4px;
    font-size:12px; color:var(--muted);
  }
  .pill{
    display:inline-block; padding:6px 10px; border-radius:999px;
    font-size:12px; line-height:1; background:#f3f4f6; color:#111;
    border:1px solid var(--line);
  }
  .pill.red{
    background:#ffe6e9; color:#9a1027; border-color:#f2b7bf;
  }

  .seek-title{
    margin:10px 0 8px; font-size:16px; font-weight:700; color:var(--muted);
  }

  .details{ display:grid; gap:4px; font-size:14px; }
  .label{ font-weight:700; }
  .details, .collapsible{ margin-bottom: 14px; }

  /* Button row */
  .seek-actions{
    border-top:1px solid #e5e7eb;
    padding-top:12px;
    margin-top:auto;
    display:flex; gap:10px; flex-wrap:wrap;
  }

  /* Modal */
  .modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center;
    background:rgba(0,0,0,0.45); z-index:9998; padding:20px;}
  .modal.open{ display:flex; }
  .modal-card{
    background:#fff; border-radius:var(--radius); border:1px solid var(--line);
    max-width:560px; width:100%; padding:18px;
  }
  .modal h3{ margin:0 0 8px; font-size:18px; }
  .modal p{ margin:0 0 14px; color:var(--muted); }
  .row{ display:flex; gap:10px; align-items:center; }
  .row > *{ flex:1; }
  .field{ margin-bottom:10px; }
  .field .label{ display:block; font-size:13px; margin-bottom:6px; font-weight:700; }
  input[type="text"], input[type="email"], input[type="tel"], textarea, select{
    width:100%; border:1px solid var(--line); border-radius:8px;
    padding:10px 12px; font-size:14px; outline:none; background:#fff;
  }
  textarea{ min-height:90px; resize:vertical; }
  .actions{ display:flex; gap:10px; margin-top:12px; flex-wrap:wrap; }
  .btn.secondary{ background:#f3f4f6; color:#111; border:1px solid var(--line); }

  /* Footer */
  .footer{
    background:var(--bni-red); height:var(--footer-h);
    display:flex; align-items:center; justify-content:center; color:#fff; font-weight:600;
    letter-spacing:.3px;
  }

  /* Sticky badge */
  .powered-by{
    position:fixed; right:18px; bottom:18px; z-index:9999;
    display:inline-flex; align-items:center; gap:var(--badge-gap);
    background:rgba(255,255,255,0.9); border:1px solid rgba(0,0,0,0.08);
    border-radius:999px; padding:8px 12px; box-shadow:0 6px 18px rgba(0,0,0,0.08);
    opacity:var(--badge-opacity); transition:opacity .2s ease; backdrop-filter:blur(6px);
  }
  .powered-by:hover{ opacity:1; }
  .powered-by span{ font-size:var(--badge-size); line-height:1; color:#111827; white-space:nowrap; }
  .powered-by img{ height:calc(var(--badge-size) + 6px); width:auto; display:block; }
</style>
</head>

<body>
  <div class="site">
    <div class="topbar" aria-hidden="true"></div>

    <div class="brand-row">
      <img class="logo" src="https://d34hmiuaex7c0.cloudfront.net/6568/uploads/cmaspages/gallery/galleryitem_1759854726598.png" alt="BNI Rock Solid Referrals Logo">
    </div>

    <main class="content" role="main">
      <div class="page-head">
        <h1 class="page-title">Seek of the Week — Submissions</h1>
        <a class="btn" href="https://kakatbarilea-prog.github.io/bni-seek-of-the-week-page/">Submit a Seek</a>
      </div>

      <!-- Filters -->
      <div class="filters">
        <input id="searchInput" class="input" type="text" aria-label="Search seeks" placeholder="Search by name, company, industry, title, notes…">
        <select id="sortSelect" class="select" aria-label="Sort results">
          <option value="newest">Sort: Newest first</option>
          <option value="oldest">Sort: Oldest first</option>
          <option value="referrals_desc">Sort: Most referrals</option>
          <option value="referrals_asc">Sort: Fewest referrals</option>
          <option value="type_az">Sort: Type A→Z</option>
        </select>
      </div>

      <!-- Cards -->
      <section class="cards" id="cards"></section>
    </main>

    <footer class="footer" role="contentinfo">
      <div>BNI Rock Solid Referrals</div>
    </footer>
  </div>

  <!-- Sticky badge -->
  <a class="powered-by" href="https://segwik.com/" aria-label="Powered by Segwik (opens portal)" target="_blank" rel="noopener">
    <span>Powered by</span>
    <img src="https://d34hmiuaex7c0.cloudfront.net/6568/uploads/cmaspages/gallery/galleryitem_1759854883923.png" alt="Segwik">
  </a>

  <!-- “I know” Modal -->
  <div class="modal" id="knowModal" role="dialog" aria-modal="true" aria-labelledby="knowTitle">
    <div class="modal-card">
      <h3 id="knowTitle">Offer an Introduction</h3>
      <p id="knowSubtitle"></p>

      <div class="field">
        <div class="row">
          <div>
            <label class="label">Your First Name</label>
            <input type="text" id="k_first">
          </div>
          <div>
            <label class="label">Your Last Name</label>
            <input type="text" id="k_last">
          </div>
        </div>
      </div>

      <div class="row field">
        <div>
          <label class="label">Your Company</label>
          <input type="text" id="k_company">
        </div>
        <div>
          <label class="label">Your Email</label>
          <input type="email" id="k_email">
        </div>
      </div>

      <div class="field">
        <label class="label">Your Phone</label>
        <input type="tel" id="k_phone">
      </div>

      <div id="k_dynamic"></div>

      <div class="actions">
        <button class="btn" id="k_send">Send Response</button>
        <button class="btn secondary" id="k_cancel" type="button">Cancel</button>
      </div>
    </div>
  </div>

<script>
/* ===== Demo + persistence ===== */
const LIST_KEY = "bni_seek_requests_list_ui_profile_v1";

/* Utilities */
const $  = (s, el=document) => el.querySelector(s);
const $$ = (s, el=document) => Array.from(el.querySelectorAll(s));
const uid = () => Math.random().toString(36).slice(2,9);
const fmtDate = (ts) => {
  const d = new Date(ts);
  return d.toLocaleDateString(undefined, {month:'short', day:'numeric', year:'numeric'});
};

/* Demo data with requester + optional avatar */
const now = Date.now(), day = 86400000;
const demo = [
  { id:"d1", type:"persona", createdAt: now - 2*60*60*1000,
    requesterName:"Pete Romano", avatar:"", // put URL if you have one
    referrals:[{id:"r1",name:"Casey Nguyen"}],
    personaIndustry:"Real Estate", personaTitle:"Office Manager", personaSeniority:"Mid-Level",
    whatActions:"Ask for a 15-minute discovery call.",
    whatSay:"We reduce admin back-and-forth with a simple portal.",
    notes:"Within 25 miles of Oakhurst."
  },
  { id:"d2", type:"company", createdAt: now - 1*day - 3*60*60*1000,
    requesterName:"Alicia Chen", avatar:"",
    referrals:[{id:"r2",name:"Alex Wu"}],
    companyName:"Acme Builders LLC",
    whatActions:"Intro via LinkedIn and share calendar link.",
    whatSay:"Pete’s team can streamline subcontractor onboarding.",
    notes:"Open to meeting on Fridays."
  },
  { id:"d3", type:"person", createdAt: now - 7*day - 2*60*60*1000,
    requesterName:"Marcus Hill", avatar:"",
    referrals:[],
    personFirst:"Jordan", personLast:"Lee", personCompany:"Lee Home Inspections",
    whatActions:"Warm email intro and include both parties.",
    whatSay:"Jordan helped our buyers avoid a costly issue — worth a quick chat.",
    notes:"Monmouth County homeowners preferred."
  },
  { id:"d4", type:"person", createdAt: now - 20*day,
    requesterName:"Sam Patel", avatar:"",
    referrals:[{id:"r4",name:"Sofia"}],
    personFirst:"Dana", personLast:"Kim", personCompany:"",
    whatActions:"Make a group text intro.",
    whatSay:"Dana is a trusted adviser for investment buyers.",
    notes:"Best reached in afternoons."
  },
  { id:"d5", type:"company", createdAt: new Date("2025-01-12T10:00:00").getTime(),
    requesterName:"Priya Kapoor", avatar:"",
    referrals:[],
    companyName:"Brightline Solar Inc.",
    whatActions:"Share their ops contact; we’ll send a brief capabilities deck.",
    whatSay:"Our team helped neighbors cut energy bills by 23%.",
    notes:"Prefer Mon–Thu mornings."
  },
  { id:"d6", type:"persona", createdAt: new Date("2025-02-03T14:30:00").getTime(),
    requesterName:"Jamal Carter", avatar:"",
    referrals:[{id:"r5",name:"Taylor Brooks"}],
    personaIndustry:"Healthcare", personaTitle:"HR Director", personaSeniority:"Senior",
    whatActions:"Ask for a quick intro call this week.",
    whatSay:"We modernize benefits enrollment without extra cost.",
    notes:"NJ/NY area ideal."
  }
];

function loadList(){
  const stored = localStorage.getItem(LIST_KEY);
  let list = stored ? JSON.parse(stored) : demo.slice();
  list.sort((a,b) => (b.createdAt||0) - (a.createdAt||0));
  localStorage.setItem(LIST_KEY, JSON.stringify(list));
  return list;
}
function saveList(list){ localStorage.setItem(LIST_KEY, JSON.stringify(list)); }

/* Labels */
function typeLabel(t){
  if(t==="person") return "Specific Person";
  if(t==="company") return "Specific Company";
  return "Type of Person";
}
function actionButtonText(t){
  if(t==="person") return "I know her/him";
  if(t==="company") return "I know this company";
  return "I know someone";
}

/* Avatar helper (initials if no image) */
function renderAvatar(name, url){
  if(url){
    return `<span class="avatar"><img src="${url}" alt="${name}"></span>`;
  }
  const initials = (name||"").split(" ").map(p=>p[0]).slice(0,2).join("").toUpperCase() || "?";
  return `<span class="avatar" aria-hidden="true">${initials}</span>`;
}

/* Card factory */
function renderCard(req){
  const wrap = document.createElement("article");
  wrap.className = "seek-card";
  wrap.dataset.id = req.id;

  // Top: avatar + “NAME is looking for a TYPE”
  const top = document.createElement("div");
  top.className = "seek-top";
  top.innerHTML = `
    ${renderAvatar(req.requesterName || "Member", req.avatar)}
    <div>
      <p class="who-line"><span class="name">${req.requesterName || "A Member"}</span> is looking for a <span class="type">${typeLabel(req.type)}</span>.</p>
      <div class="meta">
        <span class="pill">${typeLabel(req.type)}</span>
        <span>Submitted On: ${fmtDate(req.createdAt || Date.now())}</span>
        <span class="pill red" data-role="count">${(req.referrals||[]).length} referral${(req.referrals||[]).length===1?'':'s'}</span>
      </div>
    </div>
  `;

  const title = document.createElement("h3");
  title.className = "seek-title";
  title.textContent = "Request Details";

  const det = document.createElement("div");
  det.className = "details";
  if(req.type === "person"){
    const full = [req.personFirst, req.personLast].filter(Boolean).join(" ");
    det.innerHTML = `
      <div><span class="label">Name:</span> ${full || "—"}</div>
      <div><span class="label">Company:</span> ${req.personCompany || "—"}</div>
      <div><span class="label">How You Can Help or Get Involved:</span> ${req.whatActions || "—"}</div>
      <div><span class="label">What to Share or Talk About:</span> ${req.whatSay || "—"}</div>
      <div><span class="label">Additional Notes:</span> ${req.notes || "—"}</div>
    `;
  } else if(req.type === "company"){
    det.innerHTML = `
      <div><span class="label">Company:</span> ${req.companyName || "—"}</div>
      <div><span class="label">How You Can Help or Get Involved:</span> ${req.whatActions || "—"}</div>
      <div><span class="label">What to Share or Talk About:</span> ${req.whatSay || "—"}</div>
      <div><span class="label">Additional Notes:</span> ${req.notes || "—"}</div>
    `;
  } else {
    det.innerHTML = `
      <div><span class="label">Industry:</span> ${req.personaIndustry || "—"}</div>
      <div><span class="label">Job Title:</span> ${req.personaTitle || "—"}</div>
      <div><span class="label">Experience / Seniority:</span> ${req.personaSeniority || "—"}</div>
      <div><span class="label">How You Can Help or Get Involved:</span> ${req.whatActions || "—"}</div>
      <div><span class="label">What to Share or Talk About:</span> ${req.whatSay || "—"}</div>
      <div><span class="label">Additional Notes:</span> ${req.notes || "—"}</div>
    `;
  }

  const actions = document.createElement("div");
  actions.className = "seek-actions";
  const actBtn = document.createElement("button");
  actBtn.className = "btn";
  actBtn.textContent = actionButtonText(req.type);
  actBtn.addEventListener("click", () => openKnowModal(req));
  actions.appendChild(actBtn);

  wrap.appendChild(top);
  wrap.appendChild(title);
  wrap.appendChild(det);
  wrap.appendChild(actions);

  return wrap;
}

/* Search + sort + render */
let ALL = loadList();
function filterAndSort(list){
  const q = ($("#searchInput").value || "").toLowerCase().trim();
  let out = list.filter(item => {
    const hay = [
      item.requesterName,
      typeLabel(item.type),
      item.companyName,
      item.personaIndustry, item.personaTitle, item.personaSeniority,
      [item.personFirst, item.personLast].filter(Boolean).join(" "),
      item.whatActions, item.whatSay, item.notes
    ].join(" ").toLowerCase();
    return !q || hay.includes(q);
  });

  const sort = $("#sortSelect").value;
  if(sort === "oldest") out.sort((a,b)=> (a.createdAt||0)-(b.createdAt||0));
  else if(sort === "referrals_desc") out.sort((a,b)=> (b.referrals?.length||0)-(a.referrals?.length||0));
  else if(sort === "referrals_asc") out.sort((a,b)=> (a.referrals?.length||0)-(b.referrals?.length||0));
  else if(sort === "type_az") out.sort((a,b)=> typeLabel(a.type).localeCompare(typeLabel(b.type)));
  else out.sort((a,b)=> (b.createdAt||0)-(a.createdAt||0)); // newest

  return out;
}
function renderAll(){
  const wrap = $("#cards");
  wrap.innerHTML = "";
  filterAndSort(ALL).map(renderCard).forEach(el => wrap.appendChild(el));
}
$("#searchInput").addEventListener("input", renderAll);
$("#sortSelect").addEventListener("change", renderAll);

/* “I know” modal logic */
let currentReq = null;
function openKnowModal(req){
  currentReq = req;
  $("#knowTitle").textContent = "Offer an Introduction";
  $("#knowSubtitle").textContent =
    `You're responding to ${req.requesterName || "this member"} — ${typeLabel(req.type)}.`;

  // Build dynamic fields per type
  const box = $("#k_dynamic");
  box.innerHTML = "";
  if(req.type === "person"){
    box.innerHTML = `
      <div class="field">
        <label class="label">Relationship / How you know them</label>
        <input type="text" id="k_relation">
      </div>
      <div class="field">
        <label class="label">Write a quick message to help them out</label>
        <textarea id="k_message"></textarea>
      </div>
    `;
  } else if(req.type === "company"){
    box.innerHTML = `
      <div class="field">
        <label class="label">Person you’re connected with in this company</label>
        <input type="text" id="k_contactName">
      </div>
      <div class="field">
        <label class="label">Relationship / How you know them</label>
        <input type="text" id="k_relation">
      </div>
      <div class="field">
        <label class="label">Write a quick message to help them out</label>
        <textarea id="k_message"></textarea>
      </div>
    `;
  } else {
    box.innerHTML = `
      <div class="field">
        <label class="label">Name of the Person you know</label>
        <input type="text" id="k_contactName">
      </div>
      <div class="field">
        <label class="label">Relationship / How you know them</label>
        <input type="text" id="k_relation">
      </div>
      <div class="field">
        <label class="label">Write a quick message to help them out</label>
        <textarea id="k_message"></textarea>
      </div>
    `;
  }

  $("#knowModal").classList.add("open");
}
function closeKnowModal(){
  $("#knowModal").classList.remove("open");
  currentReq = null;
}
$("#k_cancel").addEventListener("click", closeKnowModal);
document.addEventListener("keydown", (e)=> {
  if(e.key==="Escape" && $("#knowModal").classList.contains("open")) closeKnowModal();
});
$("#knowModal").addEventListener("click", (e)=> {
  if(e.target.id === "knowModal") closeKnowModal();
});

$("#k_send").addEventListener("click", () => {
  if(!currentReq) return;
  const first = $("#k_first").value.trim();
  const last  = $("#k_last").value.trim();
  const email = $("#k_email").value.trim();
  const phone = $("#k_phone").value.trim();
  if(!first || !last){ alert("Please provide your first and last name."); return; }
  if(!email && !phone){ alert("Please provide your email or phone."); return; }

  const referral = {
    id: uid(),
    yourFirst:first,
    yourLast:last,
    yourCompany: $("#k_company").value.trim(),
    yourEmail: email,
    yourPhone: phone,
    contactName: $("#k_contactName")?.value?.trim() || "",
    relation: $("#k_relation")?.value?.trim() || "",
    message: $("#k_message")?.value?.trim() || "",
    createdAt: Date.now()
  };

  // Persist
  const list = ALL.slice();
  const idx = list.findIndex(r => r.id === currentReq.id);
  if(idx !== -1){
    list[idx].referrals = list[idx].referrals || [];
    list[idx].referrals.push(referral);
    ALL = list;
    saveList(ALL);
  }

  closeKnowModal();
  renderAll();
});

/* Init */
renderAll();
</script>
</body>
</html>
